{"ast":null,"code":"var _jsxFileName = \"/Users/denisanufriev/PycharmProjects/PythonProject5/yolo_camera_project/frontend/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend } from \"chart.js\";\nimport { Bar } from \"react-chartjs-2\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\nfunction App() {\n  _s();\n  const [tab, setTab] = useState(\"main\");\n  const [count, setCount] = useState(null);\n  const [stats, setStats] = useState([]);\n  const videoRef = useRef(null);\n\n  // Камера и детекция (можно упростить если не нужна автодетекция)\n  useEffect(() => {\n    if (tab === \"main\") {\n      const startCamera = async () => {\n        try {\n          const stream = await navigator.mediaDevices.getUserMedia({\n            video: true\n          });\n          if (videoRef.current) {\n            videoRef.current.srcObject = stream;\n          }\n        } catch (e) {\n          console.error(\"Ошибка доступа к камере:\", e);\n        }\n      };\n      startCamera();\n\n      // Опционально: автоматическая детекция (если нужен счетчик)\n      const interval = setInterval(handleDetect, 2000); // каждые 2 сек\n      return () => clearInterval(interval);\n    }\n  }, [tab]);\n\n  // Получение статистики при переключении во вкладку \"Статистика\"\n  useEffect(() => {\n    if (tab === \"stats\") {\n      fetch(\"http://localhost:8000/api/v1/attendance\").then(res => res.json()).then(data => setStats(Array.isArray(data) ? data : [])).catch(() => setStats([]));\n    }\n  }, [tab]);\n  const handleDetect = async () => {\n    try {\n      const res = await fetch(\"http://localhost:8000/api/v1/detect-live\");\n      const data = await res.json();\n      setCount(data.count);\n    } catch (e) {\n      setCount(null);\n    }\n  };\n\n  // Готовим данные для графика\n  const chartData = {\n    labels: stats.map(item => {\n      const date = new Date(item.timestamp);\n      return `${date.getHours()}:${date.getMinutes().toString().padStart(2, \"0\")}`;\n    }),\n    datasets: [{\n      label: \"Посещаемость\",\n      data: stats.map(item => item.count),\n      backgroundColor: \"#2563eb\"\n    }]\n  };\n  const chartOptions = {\n    responsive: true,\n    plugins: {\n      legend: {\n        position: \"top\"\n      },\n      title: {\n        display: true,\n        text: \"Статистика посещаемости по времени\"\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: \"2rem\",\n      fontFamily: \"Arial, sans-serif\",\n      textAlign: \"center\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"\\uD83C\\uDF93 YOLO Student Counter\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: \"1rem\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setTab(\"main\"),\n        style: {\n          marginRight: \"1rem\"\n        },\n        children: \"\\u041A\\u0430\\u043C\\u0435\\u0440\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setTab(\"stats\"),\n        children: \"\\u0421\\u0442\\u0430\\u0442\\u0438\\u0441\\u0442\\u0438\\u043A\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), tab === \"main\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        autoPlay: true,\n        muted: true,\n        playsInline: true,\n        style: {\n          width: \"640px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this), count !== null && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          marginTop: \"1rem\",\n          fontSize: \"18px\"\n        },\n        children: [\"\\uD83E\\uDDCD \\u041D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E: \", count]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }, this), tab === \"stats\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u041F\\u043E\\u0441\\u0435\\u0449\\u0430\\u0435\\u043C\\u043E\\u0441\\u0442\\u044C \\u043F\\u043E \\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u0438\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 11\n      }, this), Array.isArray(stats) && stats.length > 0 ? /*#__PURE__*/_jsxDEV(Bar, {\n        data: chartData,\n        options: chartOptions\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u041D\\u0435\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0434\\u043B\\u044F \\u043E\\u0442\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u044F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"ZuP1Vy9SclyGnJ4KRLKlMv3pV/k=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useRef","useState","Chart","ChartJS","CategoryScale","LinearScale","BarElement","Title","Tooltip","Legend","Bar","jsxDEV","_jsxDEV","register","App","_s","tab","setTab","count","setCount","stats","setStats","videoRef","startCamera","stream","navigator","mediaDevices","getUserMedia","video","current","srcObject","e","console","error","interval","setInterval","handleDetect","clearInterval","fetch","then","res","json","data","Array","isArray","catch","chartData","labels","map","item","date","Date","timestamp","getHours","getMinutes","toString","padStart","datasets","label","backgroundColor","chartOptions","responsive","plugins","legend","position","title","display","text","style","padding","fontFamily","textAlign","children","fileName","_jsxFileName","lineNumber","columnNumber","marginBottom","onClick","marginRight","ref","autoPlay","muted","playsInline","width","marginTop","fontSize","length","options","_c","$RefreshReg$"],"sources":["/Users/denisanufriev/PycharmProjects/PythonProject5/yolo_camera_project/frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  BarElement,\n  Title,\n  Tooltip,\n  Legend,\n} from \"chart.js\";\nimport { Bar } from \"react-chartjs-2\";\n\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\n\nfunction App() {\n  const [tab, setTab] = useState(\"main\");\n  const [count, setCount] = useState(null);\n  const [stats, setStats] = useState([]);\n  const videoRef = useRef(null);\n\n  // Камера и детекция (можно упростить если не нужна автодетекция)\n  useEffect(() => {\n    if (tab === \"main\") {\n      const startCamera = async () => {\n        try {\n          const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n          if (videoRef.current) {\n            videoRef.current.srcObject = stream;\n          }\n        } catch (e) {\n          console.error(\"Ошибка доступа к камере:\", e);\n        }\n      };\n      startCamera();\n\n      // Опционально: автоматическая детекция (если нужен счетчик)\n      const interval = setInterval(handleDetect, 2000); // каждые 2 сек\n      return () => clearInterval(interval);\n    }\n  }, [tab]);\n\n  // Получение статистики при переключении во вкладку \"Статистика\"\n  useEffect(() => {\n    if (tab === \"stats\") {\n      fetch(\"http://localhost:8000/api/v1/attendance\")\n        .then((res) => res.json())\n        .then((data) => setStats(Array.isArray(data) ? data : []))\n        .catch(() => setStats([]));\n    }\n  }, [tab]);\n\n  const handleDetect = async () => {\n    try {\n      const res = await fetch(\"http://localhost:8000/api/v1/detect-live\");\n      const data = await res.json();\n      setCount(data.count);\n    } catch (e) {\n      setCount(null);\n    }\n  };\n\n  // Готовим данные для графика\n  const chartData = {\n    labels: stats.map((item) => {\n      const date = new Date(item.timestamp);\n      return `${date.getHours()}:${date.getMinutes().toString().padStart(2, \"0\")}`;\n    }),\n    datasets: [\n      {\n        label: \"Посещаемость\",\n        data: stats.map((item) => item.count),\n        backgroundColor: \"#2563eb\",\n      },\n    ],\n  };\n\n  const chartOptions = {\n    responsive: true,\n    plugins: {\n      legend: { position: \"top\" },\n      title: { display: true, text: \"Статистика посещаемости по времени\" },\n    },\n  };\n\n  return (\n    <div style={{ padding: \"2rem\", fontFamily: \"Arial, sans-serif\", textAlign: \"center\" }}>\n      <h1>🎓 YOLO Student Counter</h1>\n      <div style={{ marginBottom: \"1rem\" }}>\n        <button onClick={() => setTab(\"main\")} style={{ marginRight: \"1rem\" }}>\n          Камера\n        </button>\n        <button onClick={() => setTab(\"stats\")}>Статистика</button>\n      </div>\n      {tab === \"main\" && (\n        <div>\n          <video ref={videoRef} autoPlay muted playsInline style={{ width: \"640px\" }} />\n          {count !== null && (\n            <p style={{ marginTop: \"1rem\", fontSize: \"18px\" }}>🧍 Найдено: {count}</p>\n          )}\n        </div>\n      )}\n      {tab === \"stats\" && (\n        <div>\n          <h2>Посещаемость по времени</h2>\n          {Array.isArray(stats) && stats.length > 0 ? (\n            <Bar data={chartData} options={chartOptions} />\n          ) : (\n            <p>Нет данных для отображения</p>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}